from tkinter import Y
import PreparingMatrix
import SmileKmer
import numpy as np
import ReadingFasta

#Ligand Dictionary
ligand_dict = {"pS6_DE_1p_citronellol.csv":'CC(CCC=C(C)C)CCO', "pS6_DE_1p_isoamylAcetate.csv":'CC(C)CCOC(=O)C', "pS6_DE_1p_ethylTiglate.csv":'CCOC(=O)C(=CC)C',
"pS6_DE_1p_bIonone.csv":'CC1=C(C(CCC1)(C)C)C=CC(=O)C', "pS6_DE_1p_butyricAcid.csv":'CCCC(=O)O', "pS6_DE_1p_paraCresol.csv":'CC1=CC=C(C=C1)O', "pS6_DE_1p_bCaryophyllene.csv":'CC1=CCCC(=C)C2CC(C2CC1)(C)C',
"pS6_DE_p1_isovalericAcid.csv":'CC(C)CC(=O)O', "pS6_DE_1p_Octanal.csv":'CCCCCCCC=O', "pS6_DE_1p_heptanal.csv":'CCCCCCC=O', "pS6_DE_1p_tbm.csv":'CC(C)(C)S', "pS6_DE_1p_bDamascone.csv":'CC=CC(=O)C1=C(CCCC1(C)C)C',
"pS6_DE_1p_pyridine.csv":'C1=CC=NC=C1', "pS6_DE_1p_propionicAcid.csv":'CCC(=O)O', "pS6_DE_1p_methylSalicylate.csv":'COC(=O)C1=CC=CC=C1O', "pS6_DE_p01_e2butene1thiol.csv":'CC=CCS',
"pS6_DE_1p_3methyl1butanethiol.csv":'CC(C)CCS', "pS6_DE_1p_ethylButyrate.csv":'CCCC(=O)OCC', "pS6_DE_1p_hexylTiglate.csv":'CCCCCCOC(=O)C(=CC)C', "pS6_DE_1p_indole.csv":'C1=CC=C2C(=C1)C=CN2',
"pS6_DE_500mM_2propylthietane.csv":'CCCC1CCS1', "pS6_DE_1p_2heptanone.csv":'CCCCCC(=O)C', "pS6_DE_p01_cyclopentanethiol.csv":'C1CCC(C1)S',
"pS6_DE_1p_dimethyltrisulfide.csv":'CSSSC', "pS6_DE_1p_guaiacol.csv":'COC1=CC=CC=C1O', "pS6_DE_1p_Benzaldehyde.csv":'C1=CC=C(C=C1)C=O', "pS6_DE_p01_citral.csv":'CC(=CCCC(=CC=O)C)C',
"pS6_DE_3mM_androstenone.csv":'CC12CCC3C(C1CC=C2)CCC4C3(CCC(=O)C4)C', "pS6_DE_100p_ebFarnesene.csv":'CC(=CCCC(=CCCC(=C)C=C)C)C', "pS6_DE_1p_acetophenone.csv":'CC(=O)C1=CC=CC=C1',
"pS6_DE_1p_transCinnamaldehyde.csv":'C1=CC=C(C=C1)C=CC=O', "pS6_DE_1p_linalool.csv":'CC(=CCCC(C)(C=C)O)C', "pS6_DE_1p_2hexanone.csv":'CCCCC(=O)C', "pS6_DE_1p_isopropylTiglate.csv":'CC=C(C)C(=O)OC(C)C',
"pS6_DE_1p_aPinene.csv":'CC1=CCC2CC1C2(C)C', "pS6_DE_1p_diacetyl.csv":'CC(=O)C(=O)C', "pS6_DE_1p_geranoil.csv":'CC(=CCCC(=CCO)C)C', "pS6_DE_1p_heptanoicAcid.csv":'CCCCCCC(=O)O'}

###NOTE: logFC values are unaltered!!!!

citronollel_logFC_dict = {Q8VET1:-1.600866537, Q8VFR3:0.229696618, Q8VGZ7:-0.269737375, Q8VG59:0.022053206, Q8VF91:-0.127658101, Q8VGD7:-0.094061825, Q8VGC8:0.069737098,
                    Q8VFM9:0.488840896, A2AVB5:-0.029297203, L7N1X3:0.087351421, Q8VEZ3:0.285408713, A0A1L1SQF6:-0.295384082, Q8VGC7:1.81e-16, Q8VGC6:0.181842682,
                    A0A1D5RLR5:1.061930439, Q7TQV4:-0.295409074, Q7TQV7:0.265505364, Q8VH21:-0.243137974, Q8VFZ6:1.81e-16, Q8VFZ2:0.011272231, Q9EQ90:0.375776293,
                    Q8VGJ3:-0.015515397, E9Q840:0.095829646, Q8VGJ7:0.799494304, Q8VGJ5:0.313035438, Q9R0K2:0.438764079, Q60881:0.232867814, Q8VFU6:-0.881374088,
                    E9PYP4:0.01126841, Q8VFU9:0.212620056, Q8VG27:0.190681368, E9Q1P0:0.039561797, Q7TS48:0.276730335, Q8VH10:-0.643543693, Q8VGM2:0.462268667,
                    L7N1Y6:0.379973772, Q7TQU8:0.388708624, Q8VES9:-0.072292977, Q8VGS0:0.368507618, Q8VGS3:-0.068147628, Q7TRH8:0.231645472, Q8VGS7:-0.27953784,
                    E9Q5F1:-0.024473618, Q8VGK2:1.923949688, Q8VFE7:-0.006563816, E9Q2B9:-0.178697143, L7MU75:0.366574404, Q8VGK8:0.566874523, Q8VF14:0.431931564,
                    Q7TRM0:0.147528422, Q8VF13:0.277096197, L7N1Z5:0.443676545, Q8VGA1:-0.112925679, A3KPP7:1.207761113, Q8VGX8:0.306889571, Q8VFT4:0.124939311,
                    Q8VFT6:0.43561814, Q8VGX5:-0.040328575, Q8VGA9:0.04919644, Q8VGX7:-0.073044281, L7N1Z8:-0.025035709, Q8VGY9:-0.354019461, Q8VGX2:0.406845331,
                    Q8VGW8:0.450300903, Q8VH01:0.666254134, Q8VH00:0.22501033, Q7TRX7:0.660169064, Q7TR67:0.639968874, E9Q542:0.239204286, Q8VGP9:0.086765458,
                    A0A1L1SUC9:-0.109756423, Q7TQT8:0.425479216, Q8VFE3:0.179066984, L7N210:-0.009504751, Q0VEV7:0.525102074, Q8VEZ5:-0.189198243,
                    Q8VET5:-1.123719823, Q8VFD2:0.480949671, Q7TRX0:0.098316388, Q7TRX3:-0.235387912, Q8VF05:0.157747799, Q8VF06:0.107181208, Q8VGH1:-0.015122152,
                    Q8VGH2:0.122121621, E9Q5P8:0.228098677, Q8VFW8:0.4405254, Q8VF18:0.186868851, Q3KPA8:-0.772257762, Q8VFW5:0.714553821, Q8VGY6:-0.061345745,
                    Q8VGN0:-0.071783446, Q8VFW3:0.657219797, Q8VGQ3:0.300511272, Q8VGR9:-0.467675578, Q8VGQ7:0.388281658, Q8VGQ6:1.174339165, Q8VF17:2.491283348,
                    Q8VGY4:-0.144669565, Q7TR71:0.212978511, Q8VFE8:0.297746111, E9Q0M4:0.033592034, Q8VG01:0.153881429, Q8VEU1:0.217402886, L7N205:0.243495341,
                    Q8VEU7:0.225730767, Q8VEU6:-0.261558267, Q7TRN7:-0.090923586, Q8VFG9:0.217150849, Q8VH20:0.216224848, Q8VGI3:-0.408836958, Q8VGI2:-0.168291636,
                    Q8VFG1:0.060043456, Q8VGI4:0.050593755, Q7TQY1:1.929350574, Q8VFA9:0.08366015, Q8VFX1:-0.233721949, Q7TR49:-0.590125225, Q8VEV7:0.03840045,
                    A2RT31:0.260274274, Q9EQ84:-0.39619469, Q8VF64:-2.11541654, Q8VGG9:-1.14786667, A2ATE5:-0.62266586, Q8VGV6:-0.285492325, Q8VGV7:-0.277785804,
                    Q8VGV1:0.077829673, A0A1L1SQT2:-0.360426394, Q8VG72:0.075670155, Q8VG04:-0.500568607, Q8VG06:0.041175296, Q8VG07:0.437232024, Q8VEY3:0.121944062,
                    Q924H8:0.079653291, Q7TRV2:0.15220229, Q8VG09:0.522449743, Q7TQR3:-0.011313272, Q7TQR2:-0.131042314, Q8VG66:2.925706276, Q8VGL9:0.147698237,
                    Q8VG64:0.226770727, Q8VGL0:-1.048518417, Q8VGL3:0.393381695, Q8VGL4:0.208316537, Q8VGZ6:-0.507471615, Q8VGJ1:0.285238887, Q60895:-0.091556897,
                    Q8VEW1:-0.164708742, A2ATG2:0.036990261, Q8VGD8:-0.137912435, Q8VFQ4:-0.402397227, Q8VFQ3:0.018388534, Q8VFQ1:0.114663611, Q8VF52:-0.658648857,
                    Q7TRD9:0.38847099, E9Q438:0.126727536, Q8VGW6:0.241421091, Q8VGW1:-0.718746601, Q8VF57:-0.396498067, Q920Z2:-0.107600647, Q60882:-0.338340325,
                    Q8VF58:0.004241218, Q8VG90:-0.026359789, Q8VGW9:0.057620684, Q8VG96:-0.345271298, Q7TRD6:-0.121907747, Q8VG94:-0.284951678, Q60893:-0.311615038,
                    Q8VG16:0.274640701, Q8VG14:0.104014339, Q7TQQ4:-0.217549006, Q7TQQ7:-0.178506126, Q9EQQ5:-0.837272879, Q8VG77:-0.036376637, Q8VGP6:1.192995094,
                    Q9QWU6:0.497066563, Q7TS37:-0.167733165, Q8VFC4:0.191901188, Q8VFC6:-1.161275966, Q8VFK1:-0.403071243, Q7TRE5:-0.183503961, Q7TRE4:0.457954435,
                    Q60885:0.041998196, E9Q0Y7:-0.381804068, Q7TS38:-0.246056748, Q8VFP4:0.049793332, Q60889:-0.122931105, Q5NC59:0.475733583, Q8VGE3:-0.481643996,
                    Q8VGE1:-0.303409858, E9Q546:-0.178391992, Q8VFX4:0.165626886, Q8VGT2:0.620693187, E9Q545:-0.082071446, Q8VGT4:0.763685906, Q8VFX2:-0.151462809,
                    Q7TRA7:1.144324438, K7N609:0.584679997, Q9JHB2:-0.160600878, E9Q549:-0.36490063, Q7TRT9:0.393402693, Q9EQA6:0.612070874, Q9EPG2:0.314557083,
                    E9PWU0:-0.12876246, E9Q985:-0.075724593, Q2M2Q2:-0.047326427, Q8VG42:-0.858019158, Q8VG49:-0.233831794, Q8VF43:-0.195714284, Q7TRE6:0.040535306,
                    Q8VFG4:-0.304391035, Q7TRB0:-0.06835806, Q8VGB9:0.881224967, Q7TR59:0.010144703, E9Q413:0.275274816, Q8VGB3:-0.297651711, Q8VFJ5:-0.17487256,
                    Q7TRB9:-0.161598089, Q8VGB4:-0.017292279, Q7TRU6:0.137205102, Q8VF78:0.045755047, Q8VGU9:-0.076753765, Q8VGU8:0.282283168, Q8VGU7:-0.051264193,
                    E9Q3K2:0.550225622, Q8VGU3:0.025763785, Q8VF72:0.076084648, Q7TS51:0.506978397, E9Q0Q2:-0.512499904, Q8VGM3:0.196611473, Q7TRJ1:0.498749038,
                    Q0VEL5:0.238751759}

citronellol_pval_dict = {Q8VET1:0.006360823, Q8VFR3:0.685634485, Q8VGZ7:0.339413461, Q8VG59:0.94274988, Q8VF91:0.66949204, Q8VGD7:0.66681085, Q8VGC8:0.678789073,
                         Q8VFM9:0.021317433, A2AVB5:0.897669324, L7N1X3:0.794013963, Q8VEZ3:0.47101717, A0A1L1SQF6:0.230325445, Q8VGC7:1.0, Q8VGC6:0.556552234,
                         A0A1D5RLR5:0.261481178, Q7TQV4:0.197984005, Q7TQV7:0.526006182, Q8VH21:0.378117137, Q8VFZ6:1.0, Q8VFZ2:0.97322344, Q9EQ90:0.400925589,
                         Q8VGJ3:0.976869078, E9Q840:0.859206519, Q8VGJ7:0.034956901, Q8VGJ5:0.097948619, Q9R0K2:0.0344066, Q60881:0.469144901, Q8VFU6:0.133968988,
                         E9PYP4:0.971860482, Q8VFU9:0.122750021, Q8VG27:0.558949814, E9Q1P0:0.878234086, Q7TS48:0.435484625, Q8VH10:0.05296892, Q8VGM2:0.125308515,
                         L7N1Y6:0.415079556, Q7TQU8:0.426299692, Q8VES9:0.799710492, Q8VGS0:0.462097438, Q8VGS3:0.809373059, Q7TRH8:0.546592529, Q8VGS7:0.581047887,
                         E9Q5F1:0.925652902, Q8VGK2:0.007309438, Q8VFE7:0.964682969, E9Q2B9:0.603047878, L7MU75:0.303230909, Q8VGK8:0.061436938, Q8VF14:0.14898715,
                         Q7TRM0:0.625344241, Q8VF13:0.503788487, L7N1Z5:0.504954016, Q8VGA1:0.817927928, A3KPP7:0.044678911, Q8VGX8:0.287764907, Q8VFT4:0.753606512,
                         Q8VFT6:0.213812611, Q8VGX5:0.88582332, Q8VGA9:0.871089751, Q8VGX7:0.783563827, L7N1Z8:0.937721971, Q8VGY9:0.166098482, Q8VGX2:0.00186735,
                         Q8VGW8:0.00231437, Q8VH01:0.114492346, Q8VH00:0.374144904, Q7TRX7:0.031121683, Q7TR67:0.086940979, E9Q542:0.280734002, Q8VGP9:0.842820102,
                         A0A1L1SUC9:0.812026922, Q7TQT8:0.121200597, Q8VFE3:0.33422157, L7N210:0.984612473, Q0VEV7:0.034169441, Q8VEZ5:0.503947243,
                         Q8VET5:0.037510345, Q8VFD2:0.654457922, Q7TRX0:0.738326572, Q7TRX3:0.633134057, Q8VF05:0.435292483, Q8VF06:0.806599473, Q8VGH1:0.958716025,
                         Q8VGH2:0.389566784, E9Q5P8:0.380082329, Q8VFW8:0.090114935, Q8VF18:0.564883058, Q3KPA8:0.030598173, Q8VFW5:0.314775187, Q8VGY6:0.837679243,
                         Q8VGN0:0.827831948, Q8VFW3:0.523544258, Q8VGQ3:0.35308309, Q8VGR9:0.211025892, Q8VGQ7:0.196285664, Q8VGQ6:0.003112484, Q8VF17:1.46e-11,
                         Q8VGY4:0.523593024, Q7TR71:0.792075389, Q8VFE8:0.308539454, E9Q0M4:0.945820195, Q8VG01:0.446420243, Q8VEU1:0.456089001, L7N205:0.6059708,
                         Q8VEU7:0.369516196, Q8VEU6:0.252577771, Q7TRN7:0.719146961, Q8VFG9:0.254553397, Q8VH20:0.706839538, Q8VGI3:0.27045658, Q8VGI2:0.470839344,
                         Q8VFG1:0.879535255, Q8VGI4:0.876626454, Q7TQY1:0.130623192, Q8VFA9:0.760440563, Q8VFX1:0.349048593, Q7TR49:0.408958907, Q8VEV7:0.928772601,
                         A2RT31:0.092797582, Q9EQ84:0.253990404, Q8VF64:0.201687852, Q8VGG9:0.222661398, A2ATE5:0.132225082, Q8VGV6:0.320642509, Q8VGV7:0.298702465,
                         Q8VGV1:0.803280838, A0A1L1SQT2:0.443834314, Q8VG72:0.69491789, Q8VG04:0.193691519, Q8VG06:0.856877486, Q8VG07:0.417627506,
                         Q8VEY3:0.678123002, Q924H8:0.871951878, Q7TRV2:0.678309853, Q8VG09:0.196076887, Q7TQR3:0.954946886, Q7TQR2:0.879604867, Q8VG66:0.027958797,
                         Q8VGL9:0.514749312, Q8VG64:0.476540887, Q8VGL0:0.553925941, Q8VGL3:0.10416028, Q8VGL4:0.32651536, Q8VGZ6:0.046685465, Q8VGJ1:0.261557414,
                         Q60895:0.716482088, Q8VEW1:0.487574314, A2ATG2:0.845790671, Q8VGD8:0.389305303, Q8VFQ4:0.558092823, Q8VFQ3:0.948491696, Q8VFQ1:0.656245062,
                         Q8VF52:0.041535413, Q7TRD9:0.577360054, E9Q438:0.483108773, Q8VGW6:0.075186833, Q8VGW1:0.205596679, Q8VF57:0.037865371, Q920Z2:0.763161525,
                         Q60882:0.251537713, Q8VF58:0.986410516, Q8VG90:0.911633114, Q8VGW9:0.909431985, Q8VG96:0.162179862, Q7TRD6:0.785945326, Q8VG94:0.437894963,
                         Q60893:0.848055327, Q8VG16:0.585780251, Q8VG14:0.653315598, Q7TQQ4:0.601111694, Q7TQQ7:0.577349377, Q9EQQ5:0.15411337, Q8VG77:0.910887778,
                         Q8VGP6:0.007010414, Q9QWU6:0.262721312, Q7TS37:0.60759631, Q8VFC4:0.312146522, Q8VFC6:0.018955002, Q8VFK1:0.193135646, Q7TRE5:0.634642716,
                         Q7TRE4:0.281701211, Q60885:0.878742224, E9Q0Y7:0.136626648, Q7TS38:0.609274232, Q8VFP4:0.851897884, Q60889:0.692968728, Q5NC59:0.393894857,
                         Q8VGE3:0.278100119, Q8VGE1:0.231110787, E9Q546:0.61516361, Q8VFX4:0.623638052, Q8VGT2:0.141072589, E9Q545:0.73794009, Q8VGT4:0.030498105,
                         Q8VFX2:0.794601343, Q7TRA7:0.028843002, K7N609:0.078906723, Q9JHB2:0.603529969, E9Q549:0.261687336, Q7TRT9:0.026253065, Q9EQA6:0.068307446,
                         Q9EPG2:0.031181318, E9PWU0:0.626947735, E9Q985:0.864331891, Q2M2Q2:0.823170019, Q8VG42:0.033225617, Q8VG49:0.347148234, Q8VF43:0.382926679,
                         Q7TRE6:0.894686792, Q8VFG4:0.153634417, Q7TRB0:0.831630714, Q8VGB9:0.17304187, Q7TR59:0.974300955, E9Q413:0.526633328, Q8VGB3:0.447893803,
                         Q8VFJ5:0.815725317, Q7TRB9:0.557243876, Q8VGB4:0.97725256, Q7TRU6:0.685488977, Q8VF78:0.938515211, Q8VGU9:0.717882752, Q8VGU8:0.410280317,
                         Q8VGU7:0.879712613, E9Q3K2:0.01588223, Q8VGU3:0.935859072, Q8VF72:0.831424386, Q7TS51:0.112754107, E9Q0Q2:0.238468763, Q8VGM3:0.498945507,
                         Q7TRJ1:0.221913633, Q0VEL5:0.433579373}

#Import proteins matrix
PreparingMatrix.access_matrix()
proteins_matrix = PreparingMatrix.intermediate_matrix

#Import ligands matrix
SmileKmer.importmatrix(ligand_dict, 5, 29)
ligand_matrix = SmileKmer.ligmat
#print(ligand_matrix)

#Import dictionary
PreparingMatrix.access_dictionary()
logFC_dict = PreparingMatrix.dictionary
#print(logFC_dict)

#Concatenate protein and ligand matrices
#print(len(proteins_matrix))
#print(len(proteins_matrix[0]))
#print(len(ligand_matrix))
#print(len(ligand_matrix[0]))
final_matrix = np.concatenate((proteins_matrix, ligand_matrix), axis = 1)
#print(final_matrix)

#Create logFC vector
ReadingFasta.import_variables()
proteins = ReadingFasta.sequence_seqs
logFC = []
for protein in proteins:
    if protein.name == 'A0A1L1SRP1':
        break
    for ligand in list(ligand_dict.keys()):
        logFC.append(float(logFC_dict[str(protein.name)][ligand]))
#print(len(final_matrix))
#print(len(logFC))

"""#logFC vector
ReadingFasta.import_variables()
proteins = ReadingFasta.sequence_seqs
logFC = []
for protein in proteins:
    for ligand in list(ligand_dict.keys()):
        logFC.append(logFC_dict[frozenset([protein.name,ligand])])"""

def import_final():
    global X
    X = final_matrix
    global Y
    Y = logFC
